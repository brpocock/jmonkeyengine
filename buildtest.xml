<project name="jME Test" default="compile" basedir="." >
    <description>
        Ant Build File for the auxilliary jME Test project.
    </description>

  <property name="seg"      location="."/>

  <property name="src"        location="${seg}/src"/>
  <property name="class"      location="${seg}/testbuild"/>
  <property name="jmepackage" location="${class}/jmetest"/>
  
  <target name="init">
    <!-- Create the time stamp -->
    <tstamp/>
    <mkdir dir="${src}"/>
    <!-- Create the directory structure -->
    <mkdir dir="${class}"/>
  </target>

  <target name="compile" depends="init" description="generate jme test classes">
    <javac srcdir="${src}/jmetest"
           destdir="${class}"
           classpath="${seg}/target/jme.jar:${seg}/lib/lwjgl.jar:${seg}/lib/lwjgl_fmod3.jar:${seg}/lib/jogg-0.0.5.jar:${seg}/lib/jorbis-0.0.12.jar"
    />
    <!-- copy the resources into the build directory -->
    <copy todir="${jmepackage}/data">
      <fileset dir="${src}/jmetest/data"/>
    </copy>
  </target>

  <target name="dist" depends="compile" description="generate jme package" >
    <!-- JAR the demo classes -->
    <jar jarfile="${seg}/target/jmetest.jar" 
         basedir="${class}"
         excludes="**/data/**"
         index="yes"
    />
    
    <!-- JAR the demo data -->
    <jar jarfile="${seg}/target/jmetest-data.jar" 
         basedir="${class}"
         includes="**/jmetest/data/**"
    />
  </target>
  
  <target name="webdist" depends="dist" description="sign JARs for JNLP distribution" >
    <signjar jar="${seg}/target/jmetest.jar"
             alias="jme"
             keystore="${seg}/jnlp/jmeKeyStore"
             storepass="..."
    />
    <signjar jar="${seg}/target/jmetest-data.jar"
             alias="jme"
             keystore="${seg}/jnlp/jmeKeyStore"
             storepass="..."
    />
  </target>
  
  <target name="webdist-nativelibs" description="jar and sign native libraries for JNLP distribution" >
  	<!--  Jar and sign the Windows libraries -->
    <jar jarfile="${seg}/jnlp/lwjgl-windows.jar"
    	 basedir="lib"
         includes="lwjgl.dll"
         update="yes"
    />
    <jar jarfile="${seg}/jnlp/openal-windows.jar"
         basedir="lib"
         includes="lwjglaudio.dll"
         update="yes"
    />
    <signjar jar="${seg}/jnlp/lwjgl-windows.jar"
             alias="jme"
             keystore="${seg}/jnlp/jmeKeyStore"
             storepass="..."
    />
    <signjar jar="${seg}/jnlp/openal-windows.jar"
             alias="jme"
             keystore="${seg}/jnlp/jmeKeyStore"
             storepass="..."
    />
    
    <!-- Jar and sign Linux native libraries -->
    <jar jarfile="${seg}/jnlp/lwjgl-linux.jar"
         basedir="lib"
         includes="liblwjgl.so"
         update="yes"
    />
    <jar jarfile="${seg}/jnlp/openal-linux.jar"
         basedir="lib"
         includes="libopenal.so"
         update="yes"
    />
    <signjar jar="${seg}/jnlp/lwjgl-linux.jar"
             alias="jme"
             keystore="${seg}/jnlp/jmeKeyStore"
             storepass="..."
    />
    <signjar jar="${seg}/jnlp/openal-linux.jar"
             alias="jme"
             keystore="${seg}/jnlp/jmeKeyStore"
             storepass="..."
    />
    
    <!-- Jar (eventually) and sign Mac native libraries -->
    <signjar jar="${seg}/jnlp/lwjgl-mac.jar"
             alias="jme"
             keystore="${seg}/jnlp/jmeKeyStore"
             storepass="..."
    />
    <signjar jar="${seg}/jnlp/openal-mac.jar"
             alias="jme"
             keystore="${seg}/jnlp/jmeKeyStore"
             storepass="..."
    />
    
    <!-- Sign the lwjgl jar -->
    <signjar jar="${seg}/lib/lwjgl.jar"
             alias="jme"
             keystore="${seg}/jnlp/jmeKeyStore"
             storepass="..."
    />
    
    <!-- Sign the lwjgl fmod3 jar -->
    <signjar jar="${seg}/lib/lwjgl_fmod3.jar"
             alias="jme"
             keystore="${seg}/jnlp/jmeKeyStore"
             storepass="..."
    />
  </target>

  <target name="clean" description="clean up" >
     <delete dir="${class}"/>
     <delete>
        <fileset dir="${src}" includes="**/*.class"/>
     </delete>
  </target>

</project>