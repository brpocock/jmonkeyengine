


<h1><a name="jme3_cinematics" id="jme3_cinematics">jME3 Cinematics</a></h1>
<div class="level1">

<p>

JME3 cinematics (com.jme.cinematic) allow you to remote control nodes and cameras in a 3D game. You use cinematics to script and record scenes. Use it for example to create <object classid="java:org.netbeans.modules.javahelp.BrowserDisplayer"><param name="content" value="http://en.wikipedia.org/wiki/Cutscene"><param name="text" value="<html><u>cutscenes</u></html>"><param name="textColor" value="blue"></object> of your game.
</p>

<p>
Cinematics are implemented as AppStates. Attach the scene that you want to be visible in the cinematic to one Node. You create a Cinematic object, and add individual CinematicEvents to it. 
</p>

</div>
<!-- SECTION "jME3 Cinematics" [1-462] -->
<h2><a name="overview" id="overview">Overview</a></h2>
<div class="level2">
<pre class="code java">Cinematic cinematic <span class="sy0">=</span> <span class="kw1">new</span> Cinematic<span class="br0">&#40;</span>sceneNode, duration<span class="br0">&#41;</span>;
cinematic.<span class="me1">addCinematicEvent</span><span class="br0">&#40;</span>triggerTime, cinematicEvent<span class="br0">&#41;</span>;</pre><ol>
<li class="level1"><div class="li"> Create one Cinematic per scene.</div>
<ul>
<li class="level2"><div class="li"> sceneNode is the node containing the scene</div>
</li>
<li class="level2"><div class="li"> duration is the duration of the cinematic scene in seconds</div>
</li>
</ul>
</li>
<li class="level1"><div class="li"> Create CinematicEvents to script your “movie”. Each Cinematic is a set of CinematicEvents, that are triggered at a given time. </div>
<ul>
<li class="level2"><div class="li"> cinematicEvent is the cinematic event. More details below.</div>
</li>
<li class="level2"><div class="li"> triggerTime is the time when this particular cinematic event starts. Specify the start time in seconds since the beginning of the scene.</div>
</li>
</ul>
</li>
<li class="level1"><div class="li"> Play and pause the Cinematic using <code>cinematic.pause()</code> and <code>cinematic.play();</code></div>
</li>
</ol>

</div>
<!-- SECTION "Overview" [463-1197] -->
<h2><a name="cinematicevents" id="cinematicevents">CinematicEvents</a></h2>
<div class="level2">

<p>

There are several kinds of cinematic events:

</p>
<table class="inline">
	<tr class="row0">
		<th class="col0">CinematicEvent</th><th class="col1">Description</th>
	</tr>
	<tr class="row1">
		<td class="col0">MotionTrack</td><td class="col1">Use this to move a Spatial non-linearly over time. A motionPath is a list of several waypoints added to a MotionPath. The path is interpolated using Catmull-Rom Splines between waypoints.</td>
	</tr>
	<tr class="row2">
		<td class="col0">PositionTrack</td><td class="col1">Use this to move a Spatial linearly over time. It translates the Spatial to a destination in the given amount of time by linearly interpolating the positions.</td>
	</tr>
	<tr class="row3">
		<td class="col0">RotationTrack</td><td class="col1">Use this to change the rotation of a Spatial over time. It rotates the Spatial in the given amount of time by linearly interpolating the rotation.</td>
	</tr>
	<tr class="row4">
		<td class="col0">ScaleTrack</td><td class="col1">Use this to change the size of a Spatial over time. It scales the Spatial in the given amount of time by linearly interpolating the scale.</td>
	</tr>
	<tr class="row5">
		<td class="col0">SoundTrack</td><td class="col1">Use this to play a sound at a given time for the given duration.</td>
	</tr>
	<tr class="row6">
		<td class="col0">GuiTrack</td><td class="col1">Displays a <a href="/com/jme3/gde/core/docs/jme3/advanced/nifty_gui.html" class="wikilink1" title="jme3:advanced:nifty_gui">Nifty GUI</a> at a given time for the given duration. Use it to display subtitles or HUD elements. Bind the Nifty <acronym title="Graphical User Interface">GUI</acronym> <acronym title="Extensible Markup Language">XML</acronym> to the cinematic using <code>cinematic.bindUi(“path/to/nifty/file.xml”);</code></td>
	</tr>
	<tr class="row7">
		<td class="col0">AnimationTrack</td><td class="col1">Use this to start playing a model animation at a given time (a character walking animation for example)</td>
	</tr>
</table>

<p>

We will add more types of track implementions over time. 
</p>

<p>
Each CinematicEvent supports the following methods to control the event.

</p>
<table class="inline">
	<tr class="row0">
		<th class="col0">CinematicEvent method</th><th class="col1">Usage</th>
	</tr>
	<tr class="row1">
		<td class="col0">play()</td><td class="col1">Starts playing the cinematic.</td>
	</tr>
	<tr class="row2">
		<td class="col0">stop()</td><td class="col1">Stops playing the cinematic.</td>
	</tr>
	<tr class="row3">
		<td class="col0">pause()</td><td class="col1">Pauses the cinematic.</td>
	</tr>
</table>

<p>

Those methods, must be called on the Cinematic and are propagated to the events. Don&#039;t use them directly on a sub cinematic event
</p>

</div>
<!-- SECTION "CinematicEvents" [1198-2812] -->
<h3><a name="motiontrack_motionpath" id="motiontrack_motionpath">MotionTrack &amp; MotionPath</a></h3>
<div class="level3">

<p>

A motion track is made up of MotionPaths.
</p>
<pre class="code java">MotionPath path <span class="sy0">=</span> <span class="kw1">new</span> MotionPath<span class="br0">&#40;</span><span class="br0">&#41;</span>;</pre><table class="inline">
	<tr class="row0">
		<th class="col0"> MotionPath Method </th><th class="col1"> Usage </th>
	</tr>
	<tr class="row1">
		<td class="col0">setCycle(true)</td><td class="col1">Sets whether the motion along this path should be closed (true) or not (false). </td>
	</tr>
	<tr class="row2">
		<td class="col0">addWayPoint(vector)</td><td class="col1">Adds individual waypoints to this path. The order is relevant.</td>
	</tr>
	<tr class="row3">
		<td class="col0">removeWayPoint(vector) <br/>
 removeWayPoint(index)</td><td class="col1">Removes individual waypoints from this path. You can specify a vector or the integer index.</td>
	</tr>
	<tr class="row4">
		<td class="col0">setCurveTension(0.83f)</td><td class="col1">Sets the tension of the curve (only for Catmull Rom Spline). A value of 0.0f will give a straight linear line, 1.0 a round curve.</td>
	</tr>
	<tr class="row5">
		<td class="col0">enableDebugShape(assetManager,rootNode)</td><td class="col1">Shows a line to visualize the path. Used for debugging.</td>
	</tr>
	<tr class="row6">
		<td class="col0">disableDebugShape()</td><td class="col1">Hides the line that visualizes the path. Used for debugging.</td>
	</tr>
	<tr class="row7">
		<td class="col0">getNbWayPoints()</td><td class="col1">Returns the number of waypoints in this path.</td>
	</tr>
</table>
<pre class="code java">MotionTrack thingMotionControl <span class="sy0">=</span> <span class="kw1">new</span> MotionTrack<span class="br0">&#40;</span>thingNode, path<span class="br0">&#41;</span>;</pre><table class="inline">
	<tr class="row0">
		<th class="col0">MotionTrack method</th><th class="col1">Usage</th>
	</tr>
	<tr class="row1">
		<td class="col0">setLoopMode(LoopMode.Loop)</td><td class="col1">Sets whether the animation along this path should loop (true) or play only once (false).</td>
	</tr>
	<tr class="row2">
		<td class="col0">setDirectionType(MotionTrack.Direction.None)</td><td class="col1">Sets the direction behavior type of the controled node. Direction.None deactivates this feature. See the following options:</td>
	</tr>
	<tr class="row3">
		<td class="col0">setDirectionType(MotionTrack.Direction.LookAt)</td><td class="col1">Rotate to keep facing a point. Specify the point with setLookAt().</td>
	</tr>
	<tr class="row4">
		<td class="col0">setDirectionType(MotionTrack.Direction.Path)</td><td class="col1">Face the direction of the path.</td>
	</tr>
	<tr class="row5">
		<td class="col0">setDirectionType(MotionTrack.Direction.PathAndRotation)</td><td class="col1">Face the direction of the path, plus an added rotation. Use together with the setRotation() method.</td>
	</tr>
	<tr class="row6">
		<td class="col0">setDirectionType(MotionTrack.Direction.Rotation)</td><td class="col1">Rotate while moving. Use together with the setRotation() method.</td>
	</tr>
	<tr class="row7">
		<td class="col0">setLookAt(teapot.getWorldTranslation(), Vector3f.UNIT_Y)</td><td class="col1">Optional: Make the moving face towards a certain location. Use together with setDirectionType().</td>
	</tr>
	<tr class="row8">
		<td class="col0">setRotation(quaternion)</td><td class="col1">Optional: Sets the rotation. Use together with MotionTrack.Direction.Rotation or MotionTrack.Direction.PathAndRotation.</td>
	</tr>
</table>

</div>
<!-- SECTION "MotionTrack & MotionPath" [2813-4877] -->
<h3><a name="motionpathlistener" id="motionpathlistener">MotionPathListener</a></h3>
<div class="level3">

<p>

You can register a MotionPathListener to the MotionPath to track whether waypoints have been reached, and then trigger a custom action. In this example we just print the status. The onWayPointReach() method of the interface gives you access to the MotionTrack object <code>control</code>, and an integer value representing the current wayPointIndex.
</p>
<pre class="code java">path.<span class="me1">addListener</span><span class="br0">&#40;</span> <span class="kw1">new</span> MotionPathListener<span class="br0">&#40;</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
  <span class="kw1">public</span> <span class="kw4">void</span> onWayPointReach<span class="br0">&#40;</span>MotionTrack control, <span class="kw4">int</span> wayPointIndex<span class="br0">&#41;</span> <span class="br0">&#123;</span>
    <span class="kw1">if</span> <span class="br0">&#40;</span>path.<span class="me1">getNbWayPoints</span><span class="br0">&#40;</span><span class="br0">&#41;</span> <span class="sy0">==</span> wayPointIndex <span class="sy0">+</span> <span class="nu0">1</span><span class="br0">&#41;</span> <span class="br0">&#123;</span>
      println<span class="br0">&#40;</span>control.<span class="me1">getSpatial</span><span class="br0">&#40;</span><span class="br0">&#41;</span>.<span class="me1">getName</span><span class="br0">&#40;</span><span class="br0">&#41;</span> <span class="sy0">+</span> <span class="st0">&quot;Finished!!! &quot;</span><span class="br0">&#41;</span>;
    <span class="br0">&#125;</span> <span class="kw1">else</span> <span class="br0">&#123;</span>
      println<span class="br0">&#40;</span>control.<span class="me1">getSpatial</span><span class="br0">&#40;</span><span class="br0">&#41;</span>.<span class="me1">getName</span><span class="br0">&#40;</span><span class="br0">&#41;</span> <span class="sy0">+</span> <span class="st0">&quot; Reached way point &quot;</span> <span class="sy0">+</span> wayPointIndex<span class="br0">&#41;</span>;
    <span class="br0">&#125;</span>
  <span class="br0">&#125;</span>
<span class="br0">&#125;</span><span class="br0">&#41;</span>;</pre>
</div>
<!-- SECTION "MotionPathListener" [4878-5617] -->
<h3><a name="positiontrack" id="positiontrack">PositionTrack</a></h3>
<div class="level3">
<pre class="code java">PositionTrack thingPositionControl <span class="sy0">=</span> <span class="kw1">new</span> PositionTrack<span class="br0">&#40;</span>
    thingNode, endPosition,  duration, loopMode<span class="br0">&#41;</span>;</pre>
<p>
Details of the constructor:
</p>
<ul>
<li class="level1"><div class="li"> thingNode is the Spatial to be moved.</div>
</li>
<li class="level1"><div class="li"> endPosition is the target location as Vector3f. </div>
</li>
<li class="level1"><div class="li"> duration is the time that it should take from start to end point.</div>
</li>
<li class="level1"><div class="li"> loopMode can be LoopMode.Loop, LoopMode.DontLoop, LoopMode.Cycle.</div>
</li>
</ul>

<p>

The start location is always the current location of the Spatial.
</p>

</div>
<!-- SECTION "PositionTrack" [5618-6096] -->
<h3><a name="rotationtrack" id="rotationtrack">RotationTrack</a></h3>
<div class="level3">
<pre class="code java">RotationTrack thingRotationControl <span class="sy0">=</span> <span class="kw1">new</span> RotationTrack<span class="br0">&#40;</span>
    thingNode, endRotation,  duration, loopMode<span class="br0">&#41;</span>;</pre>
<p>
Details of the constructor:
</p>
<ul>
<li class="level1"><div class="li"> thingNode is the Spatial to be rotated.</div>
</li>
<li class="level1"><div class="li"> endRotation is the target rotation in Quaternion format. </div>
</li>
<li class="level1"><div class="li"> duration is the time that it should take from start to target rotation.</div>
</li>
<li class="level1"><div class="li"> loopMode can be LoopMode.Loop, LoopMode.DontLoop, LoopMode.Cycle.</div>
</li>
</ul>

</div>
<!-- SECTION "RotationTrack" [6097-6525] -->
<h3><a name="scaletrack" id="scaletrack">ScaleTrack</a></h3>
<div class="level3">
<pre class="code java">ScaleTrack thingScaleControl <span class="sy0">=</span> <span class="kw1">new</span> ScaleTrack<span class="br0">&#40;</span>
    thingNode, endScale,  duration, loopMode<span class="br0">&#41;</span>;</pre>
<p>
Details of the constructor:
</p>
<ul>
<li class="level1"><div class="li"> thingNode is the Spatial to be resized.</div>
</li>
<li class="level1"><div class="li"> endScale is the target Scale in Vector3f format. </div>
</li>
<li class="level1"><div class="li"> duration is the time that it should take from start to target scale.</div>
</li>
<li class="level1"><div class="li"> loopMode can be LoopMode.Loop, LoopMode.DontLoop, LoopMode.Cycle.</div>
</li>
</ul>

</div>
<!-- SECTION "ScaleTrack" [6526-6928] -->
<h3><a name="soundtrack" id="soundtrack">SoundTrack</a></h3>
<div class="level3">
<pre class="code java">SoundTrack<span class="br0">&#40;</span> audioPath, isStream, duration, loopMode <span class="br0">&#41;</span></pre>
<p>

Details of the constructor:
</p>
<ul>
<li class="level1"><div class="li"> audioPath is the path to an audio file as String, e.g. “Sounds/mySound.wav”.</div>
</li>
<li class="level1"><div class="li"> isStream Set this to true to play a longer audio file as stream, or to false to play a short sound without streaming.</div>
</li>
<li class="level1"><div class="li"> duration is the time that it should take to play.</div>
</li>
<li class="level1"><div class="li"> loopMode can be LoopMode.Loop, LoopMode.DontLoop, LoopMode.Cycle.</div>
</li>
</ul>

</div>
<!-- SECTION "SoundTrack" [6929-7376] -->
<h3><a name="guitrack" id="guitrack">GuiTrack</a></h3>
<div class="level3">
<pre class="code java">GuiTrack<span class="br0">&#40;</span> screen, duration, loopMode <span class="br0">&#41;</span></pre>
<p>

You must use this together with bindUI() to specify the Nifty <acronym title="Graphical User Interface">GUI</acronym> <acronym title="Extensible Markup Language">XML</acronym> file that you want to load:

</p>
<pre class="code java">cinematic.<span class="me1">bindUi</span><span class="br0">&#40;</span><span class="st0">&quot;Interface/subtitle.xml&quot;</span><span class="br0">&#41;</span>;</pre>
<p>
Details of the constructor:
</p>
<ul>
<li class="level1"><div class="li"> screen is the name of the Nifty <acronym title="Graphical User Interface">GUI</acronym> screen to load, as String. </div>
</li>
<li class="level1"><div class="li"> duration is the time that it should take to play.</div>
</li>
<li class="level1"><div class="li"> loopMode can be LoopMode.Loop, LoopMode.DontLoop, LoopMode.Cycle.</div>
</li>
</ul>

</div>
<!-- SECTION "GuiTrack" [7377-7834] -->
<h3><a name="animationtrack" id="animationtrack">AnimationTrack</a></h3>
<div class="level3">
<pre class="code java">AnimationTrack<span class="br0">&#40;</span> thingNode, animationName, duration, loopMode <span class="br0">&#41;</span></pre>
<p>

Details of the constructor:
</p>
<ul>
<li class="level1"><div class="li"> thingNode is the Spatial whose animation you want to play.</div>
</li>
<li class="level1"><div class="li"> AnimationName the animation of the animated model that you want to trigger, as a String.</div>
</li>
<li class="level1"><div class="li"> duration is the time that it should take to play.</div>
</li>
<li class="level1"><div class="li"> loopMode can be LoopMode.Loop, LoopMode.DontLoop, LoopMode.Cycle.</div>
</li>
</ul>

</div>
<!-- SECTION "AnimationTrack" [7835-8248] -->
<h3><a name="customizations" id="customizations">Customizations</a></h3>
<div class="level3">

<p>

You can extend individual CinematicEvents. The <object classid="java:org.netbeans.modules.javahelp.BrowserDisplayer"><param name="content" value="http://code.google.com/p/jmonkeyengine/source/browse/branches/jme3/src/test/jme3test/animation/SubtitleTrack.java"><param name="text" value="<html><u>TestCinematic.java example</u></html>"><param name="textColor" value="blue"></object>.
</p>

<p>
You can also create new CinematicEvent by extending <object classid="java:org.netbeans.modules.javahelp.BrowserDisplayer"><param name="content" value="http://code.google.com/p/jmonkeyengine/source/browse/branches/jme3/src/core/com/jme3/cinematic/events/AbstractCinematicEvent.java"><param name="text" value="<html><u>TestCinematic.java example</u></html>"><param name="textColor" value="blue"></object> is to use this for a custom fadeIn/fadeOut effect in combination with a com.jme3.post.filters.FadeFilter.
</p>

</div>
<!-- SECTION "Customizations" [8249-9298] -->
<h2><a name="camera_handling" id="camera_handling">Camera Handling</a></h2>
<div class="level2">

<p>

The camera management is handled as follows:

</p>
<ol>
<li class="level1"><div class="li"> Create a camera Node and bind the camera object to the cinematic. Note that we also give the camera node a name in this step. <pre class="code java">CameraNode camNode <span class="sy0">=</span> cinematic.<span class="me1">bindCamera</span><span class="br0">&#40;</span><span class="st0">&quot;topView&quot;</span>, cam<span class="br0">&#41;</span>;</pre></div>
</li>
<li class="level1"><div class="li"> Position the camera node in its start location.</div>
</li>
<li class="level1"><div class="li"> Use activateCamera() to give the control of the camera to this node. You now see the scene from this camera&#039;s point of view. For example to see through the camera node named “top view”, 6 seconds after the start of the cinematic, you&#039;d write <pre class="code java">cinematic.<span class="me1">activateCamera</span><span class="br0">&#40;</span><span class="nu0">6</span>, <span class="st0">&quot;topView&quot;</span><span class="br0">&#41;</span>;</pre></div>
</li>
<li class="level1"><div class="li"> If desired, attach the camNode to a MotionTrack to let it travel along waypoints. This is demonstrated in the <object classid="java:org.netbeans.modules.javahelp.BrowserDisplayer"><param name="content" value="http://code.google.com/p/jmonkeyengine/source/browse/branches/jme3/src/test/jme3test/animation/TestCinematic.java"><param name="text" value="<html><u>TestCameraMotionPath.java example</u></html>"><param name="textColor" value="blue"></object>.</div>
</li>
</ol>

<p>

Code samples:
</p>
<pre class="code java">flyCam.<span class="me1">setEnabled</span><span class="br0">&#40;</span><span class="kw2">false</span><span class="br0">&#41;</span>;
&nbsp;
CameraNode camNodeTop <span class="sy0">=</span> cinematic.<span class="me1">bindCamera</span><span class="br0">&#40;</span><span class="st0">&quot;topView&quot;</span>, cam<span class="br0">&#41;</span>;
camNodeTop.<span class="me1">setControlDir</span><span class="br0">&#40;</span>ControlDirection.<span class="me1">SpatialToCamera</span><span class="br0">&#41;</span>;
camNodeTop.<span class="me1">getControl</span><span class="br0">&#40;</span>0<span class="br0">&#41;</span>.<span class="me1">setEnabled</span><span class="br0">&#40;</span><span class="kw2">false</span><span class="br0">&#41;</span>;
&nbsp;
CameraNode camNodeSide <span class="sy0">=</span> cinematic.<span class="me1">bindCamera</span><span class="br0">&#40;</span><span class="st0">&quot;sideView&quot;</span>, cam<span class="br0">&#41;</span>;
camNodeSide.<span class="me1">setControlDir</span><span class="br0">&#40;</span>ControlDirection.<span class="me1">CameraToSpatial</span><span class="br0">&#41;</span>;
camNodeSide.<span class="me1">getControl</span><span class="br0">&#40;</span>0<span class="br0">&#41;</span>.<span class="me1">setEnabled</span><span class="br0">&#40;</span><span class="kw2">false</span><span class="br0">&#41;</span>;</pre>
</div>
<!-- SECTION "Camera Handling" [9299-10604] -->
<h2><a name="physics_interaction" id="physics_interaction">Physics Interaction</a></h2>
<div class="level2">

<p>

Upcoming.
</p>

</div>
<!-- SECTION "Physics Interaction" [10605-10648] -->
<h2><a name="more_information" id="more_information">More Information</a></h2>
<div class="level2">

<p>
See also: <object classid="java:org.netbeans.modules.javahelp.BrowserDisplayer"><param name="content" value="http://jmonkeyengine.org/groups/development-discussion-jme3/forum/topic/cinematics-system-for-jme3/"><param name="text" value="<html><u>Cinematics by Nehon</u></html>"><param name="textColor" value="blue"></object>

</p>

</div>
<!-- SECTION "More Information" [10649-] -->
<p><em><a href="http://jmonkeyengine.org/wiki/doku.php/jme3:advanced:cinematics?do=export_xhtmlbody">view online version</a></em></p>